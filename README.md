# Домашнее задание к занятию «Базы данных, их типы» - Бойко Кирилл


---

### Задание 1. СУБД

### Кейс
Крупная строительная компания, которая также занимается проектированием и девелопментом, решила создать 
правильную архитектуру для работы с данными. Ниже представлены задачи, которые необходимо решить для
каждой предметной области. 

Какие типы СУБД, на ваш взгляд, лучше всего подойдут для решения этих задач и почему? 
 
1.1. Бюджетирование проектов с дальнейшим формированием финансовых аналитических отчётов и прогнозирования рисков.
СУБД должна гарантировать целостность и чёткую структуру данных.

1.1.* Хеширование стало занимать длительно время, какое API можно использовать для ускорения работы? 

1.2. Под каждый девелоперский проект создаётся отдельный лендинг, и все данные по лидам стекаются в CRM к 
маркетологам и менеджерам по продажам. Какой тип СУБД лучше использовать для лендингов и для CRM? 
СУБД должны быть гибкими и быстрыми.

1.2.* Можно ли эту задачу закрыть одной СУБД? И если да, то какой именно СУБД и какой реализацией?

1.3. Отдел контроля качества решил создать базу по корпоративным нормам и правилам, обучающему материалу 
и так далее, сформированную согласно структуре компании. СУБД должна иметь простую и понятную структуру.

1.3.* Можно ли под эту задачу использовать уже существующую СУБД из задач выше и если да, то как лучше это 
реализовать?

1.4. Департамент логистики нуждается в решении задач по быстрому формированию маршрутов доставки материалов 
по объектам и распределению курьеров по маршрутам с доставкой документов. СУБД должна уметь быстро работать
со связями.

1.4.* Можно ли к этой СУБД подключить отдел закупок или для них лучше сформировать свою СУБД в связке с СУБД 
логистов?

1.5.* Можно ли все перечисленные выше задачи решить, используя одну СУБД? Если да, то какую именно?

*Приведите ответ в свободной форме.*

---

#### Решение 1

1.1. 
Для этой задачи лучше всего подойдет реляционная СУБД, например PostgreSQL, Oracle или MS SQL Server.

Финансовые данные требуют строгой структуры, поддержки сложных связей и, самое главное, гарантии ACID (атомарность, согласованность, изолированность, долговечность). Это критически важно для предотвращения ошибок в бюджете и отчетах.

1.1.*
Если хеширование стало узким местом, можно использовать Key-Value хранилище (например, Redis или Memcached) в качестве кеширующего слоя или API для быстрых lookup-ов. Key-Value СУБД работают в оперативной памяти и обеспечивают минимальную задержку при доступе по ключу, что значительно быстрее дисковых операций классических СУБД.

1.2. 

Лендинги: Лучше использовать NoSQL Документоориентированную СУБД (например MongoDB). Лендинги часто меняются и гибкая схема (Schema-less) позволяет хранить данные (JSON) без миграций структуры базы данных.

CRM: Можно использовать Реляционную СУБД (PostgreSQL/MySQL), так как данные о сделках и клиентах обычно структурированы. Однако, если CRM требует высокой гибкости полей для разных клиентов, подойдет и документоориентированная СУБД.

1.2.* 
Да, эту задачу можно закрыть одной СУБД. Лучший кандидат — PostgreSQL.

Реализация: PostgreSQL является объектно-реляционной системой, которая отлично поддерживает работу с JSON-документами (формат JSONB). Таким образом, строгие данные CRM можно хранить в обычных таблицах, а гибкие данные лендингов — в полях типа JSONB той же базы.
​
1.3. 
Для базы знаний со структурой компании подойдет Документоориентированная СУБД (MongoDB) или классическая Реляционная СУБД (PostgreSQL) с использованием вики-движка.

Иерархию (дерево отделов) и статьи удобно хранить как документы или связанные таблицы. Требование «простой и понятной структуры» часто реализуется не столько типом БД, сколько интерфейсом, но документная модель интуитивно ложится на структуру «статья + метаданные».

1.3.*
Да, можно использовать PostgreSQL из задач выше.

Для хранения иерархии (структуры компании) в реляционной БД используются рекурсивные запросы (Recursive CTE) или специальные типы данных (например, ltree в PostgreSQL). Тексты норм и правил можно хранить в текстовых полях, а медиафайлы — ссылками на файловое хранилище (S3) или в BLOB.

1.4.
Лучший выбор — Графовая СУБД (например, Neo4j).

Почему: Логистика — это сети (дороги, склады, курьеры). Графовые БД оптимизированы для поиска кратчайших путей и работы со сложными связями («быстрая работа со связями»), где реляционные БД теряют производительность из-за множественных JOIN-ов.
​

1.4.*
Отдел закупок оперирует классическими табличными данными (товары, счета, поставщики). Ими лучше не оперировать в графовой БД. Лучше сформировать свою схему в Реляционной СУБД (или использовать существующую), а с графовой базой логистов настроить интеграцию (связь по ID объектов).
​

1.5.*
Да, теоретически все задачи можно решить, используя мощную PostgreSQL.

Она универсальна: имеет ACID (финансы), JSONB (лендинги), рекурсию (иерархия) и расширения для графов (например, Apache AGE) или геоданных (PostGIS) для логистики. Однако для экстремальных нагрузок в специфических узлах (граф, Big Data) специализированные решения могут быть эффективнее.

---


### Задание 2. Транзакции

2.1. Пользователь пополняет баланс счёта телефона, распишите пошагово, какие действия должны произойти для того, чтобы 
транзакция завершилась успешно. Ориентируйтесь на шесть действий.

2.1.* Какие действия должны произойти, если пополнение счёта телефона происходило бы через автоплатёж?

*Приведите ответ в свободной форме.*

---

#### Решение 2

2.1
1. Проверка существования получателя и отправителя (валидация данных)
2. Проверка баланска отправителя (достаточно ли средств)
3. Открытие транзакции
4. Списание суммы у отправителя
5. Зачисление суммы получателю
6. Фиксация изменений. (Если на шагах 4-5 ошибка - отмена изменений)

2.1*
Добавляется внешний тригер - Планировщик задач
Система мониторинга или таймр инициирует событие (например каждое 1 число месяца или приближение к указанному порогу средств). Далее идут все те же действия, что и выше

---

### Задание 3. SQL vs NoSQL

3.1. Напишите пять преимуществ SQL-систем по отношению к NoSQL. 

3.1.* Какие, на ваш взгляд, преимущества у NewSQL систем перед SQL и NoSQL.

*Приведите ответ в свободной форме.*

---

#### Решение 3

3.1
Преимущества SQL перед NoSQL
1.Стандартизация: Единый язык SQL, понятный аналитикам и разработчикам, переносимый между системами.
2.ACID гарантии: Строгая согласованность данных «из коробки», критичная для финансовых операций.
3.Целостность данных: Поддержка внешних ключей (Foreign Keys) и ограничений (Constraints) на уровне схемы.
4.Сложные запросы: Мощные возможности для аналитики, JOIN-ов и агрегации данных.
5.Зрелая экосистема: Огромное количество инструментов для администрирования, бэкапов и отчетности.

3.1*
Преимущества NewSQL
NewSQL системы пытаются объединить лучшее:
1. Обеспечивают горизонтальную масштабируемость (как NoSQL).
2. Сохраняют поддержку ACID транзакций и SQL-интерфейс (как классические СУБД).
3. Обеспечивают высокую доступность (High Availability) и устойчивость к отказам узлов.

---

### Задание 4. Кластеры

Необходимо производить большое количество вычислений при работе с огромным количеством данных, под эту задачу 
выделено 1000 машин. 

На основе какого критерия будете выбирать тип СУБД и какая модель *распределённых вычислений* 
здесь справится лучше всего и почему?

*Приведите ответ в свободной форме.*

---

#### Решение 4

Критерий выбора:
Основным критерием будет CAP-теорема (выбор между согласованностью и доступностью в условиях разделения сети). Для массовых вычислений на 1000 узлов обычно важнее Устойчивость к разделению и Доступность, либо возможность линейного масштабирования. Также важен тип нагрузки.

Модель распределенных вычислений:
Лучше всего справится модель MapReduce (или аналоги, например, в Apache Spark).

Почему: При таком масштабе (1000 машин) пересылать данные к месту вычислений неэффективно. Модель MapReduce позволяет отправлять код (вычисления) к данным («Data Locality»), обрабатывать части данных параллельно на каждом узле, а затем объединять результаты. Это обеспечивает линейную масштабируемость и отказоустойчивость.
​
В качестве СУБД для хранения данных под такую модель часто выбирают колоночные NoSQL или распределенные файловые системы (HDFS).

---


